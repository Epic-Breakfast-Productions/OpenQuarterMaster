{#if itemSearchIt.hasResults()}
	{#printouts/storageBlockInventorySheet/itemTables/itemTable options=options itemSearchIt=itemSearchIt}
		{#tableHeaderCells}
			{#if options.includeNumCol}
				<th>
					#
				</th>
			{/if}
			{#if options.includeImageCol}
				<th class="imageTableCellHeader">
					Image
				</th>
			{/if}
			<th>
				Item
			</th>
			<th>
				Amount
			</th>
			{#if options.includeConditionCol}
				<th>
					Cond.
				</th>
				<th>
					Cond. Notes
				</th>
			{/if}
			<th>
				Exp.?
			</th>
		{/tableHeaderCells}
		{#tableBodyRows}
			{#for curResult in itemSearchIt}
				<tr>
					<td>in outer loop: {curResult.get("empty").asText()}</td>
				</tr>
				{#for curItem in curResult.get("results")}
					
					<tr>
						<td>in inner loop</td>
					</tr>
					{#let curWrapper = curItem.get("storageMap").get(storageBlock.get("id").asText())}
						<tr>
							{#if options.includeNumCol}
								<td class="text-center">
									{curItem_count}
								</td>
							{/if}
							{#if options.includeImageCol}
								{#if ! curItem.get("imageIds").isEmpty()}
									<td class="imageTableCell">
										{#let curImage = imageService.get(curItem.getImageIds().get(0))}
											<img src="data:{curImage.getMimeType()};base64, {curImage.getData()}" alt="Image for item {curItem.getName()}"
												class="imageTableCellImage">
										{/let}
									</td>
								{#else}
									<td></td>
								{/if}
							{/if}
							<td>
								{curItem.get("name").asText()}
							</td>
							<td>{curWrapper.get("total").get("value").asInt()}{curWrapper.get("total").get("unit").get("symbol").asText()}</td>
							
							{#if options.includeConditionCol}
								<td>{curWrapper.get("stored").get("condition").asInt()}%</td>
								<td>{curWrapper.get("stored").get("conditionNotes").asText()}</td>
							{/if}
							<td>
								{#if curWrapper.get("stored").get("expires").asText() != null}
									{curWrapper.get("stored").get("notificationStatus").get("expired").asBoolean()}
								{/if}
							</td>
							
							{! TODO:: optionally handle keywords, atts, barcode? !}
						
						</tr>
					{/let}
				{/for}
			{/for}
		{/tableBodyRows}
	{/printouts/storageBlockInventorySheet/itemTables/itemTable}
{/if}
