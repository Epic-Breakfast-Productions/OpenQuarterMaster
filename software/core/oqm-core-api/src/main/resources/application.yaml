# https://quarkus.io/guides/config-reference
service:
  version: ${quarkus.application.version}
  apiVersion: 1.0.0
  nameShort: oqm-core-api
  nameFull: Open Quarter Master Core API
  gitLink: https://github.com/Epic-Breakfast-Productions/OpenQuarterMaster
  ops:
    currency: "USD" # anything that works with `Currency.getInstance("<value>")`
  item:
    expiryCheck:
      cron: 0 0 * ? * * # Every Hour
  tempDir: "/tmp/oqm-api"
  image:
    resizing:
      enabled: true
      height: 750
      width: ${service.image.resizing.height}
      savedType: "jpg"
  dbs:
    ifNone:
      create: true
      name: "default"
      displayName: "Default"
      description: "The default database, automatically created if there are no other databases at startup."

externalService:
  secretSizeMin: 50
  secretSizeMax: 100
  serviceTokenExpires: 86400 # 1 day
  extServices:
    # Service entries here
  
quarkus:
  application:
    name: ${service.nameShort} - V${service.apiVersion}
  container-image:
    name: oqm-core-api
    group: ebprod
  log:
    level: DEBUG
    console:
#      format: "%d{HH:mm:ss} [%-5p][%-16X{traceId}|%-2X{parentId}|%-16X{spanId}|%-5X{sampled}][%-40c{2.}|%-26t] %s%e%n"
    category:
      "org.mongodb.driver":
        level: INFO
  mongodb:
    database: openQuarterMaster
  #  package:
  #    type: uber-jar
  scheduler:
  smallrye-health:
    openapi:
      included: true
  
  # https://quarkus.io/guides/openapi-swaggerui
  smallrye-openapi:
    info-title: Open QuarterMaster Base Station API
    info-version: ${service.apiVersion}
    info-description: API documentation for the Open QuarterMaster Base Station. Provides all basic functionality. Running on service version ${service.version}
    #    info-terms-of-service: <url>
    info-contact-email: greg@epic-breakfast-productions.tech
    info-contact-name: EBP
    info-contact-url: ${service.gitLink}
    info-license-name: GNU General Public License v3.0
    info-license-url: ${service.gitLink}/blob/main/LICENSE
    security-scheme: jwt
    security-scheme-name: JwtAuth
    
  swagger-ui:
    always-include: true
    title: ${quarkus.smallrye-openapi.info-title} v${service.apiVersion}
    theme: flattop
    footer: With ❤️, EBP
    urls:
      "Single Node Host Deployed": /core/api/q/openapi/
      dev: /q/openapi/
  http:
    body:
      preallocate-body-buffer: true
    limits:
      max-body-size: 750M
      max-form-attribute-size: 750M
    auth:
      proactive: false
    access-log:
      enabled: true
    port: 80
    ssl-port: 443
  messaging:
    health:
      enabled: true

mp:
  messaging:
    outgoing:
      events-outgoing:
        enabled: true
        connector: smallrye-kafka
        broadcast: true
        value:
          serializer: io.quarkus.kafka.client.serialization.ObjectMapperSerializer

smallrye:
  jwt:
    always-check-authorization: true

"%dev":
  quarkus:
    application:
      name: ${service.nameShort} - V${service.apiVersion} - DEV
    log:
      level: DEBUG
    smallrye-openapi:
      info-title: Open QuarterMaster Base Station API (DEV)
      security-scheme: basic
      security-scheme-name: BasicAuth
    mongodb:
      database: openQuarterMasterDev
#      connection-string: mongodb://test:test@localhost:27017
    http:
      port: 8080
      ssl-port: 8443
#      ssl:
#        certificate:
#          files: ../../../../dev/devTest-cert-cert.pem
#          key-files: ../../../../dev/devTest-cert-key.pem
      auth:
        basic: true
    smallrye-jwt:
      enabled: false
    security:
      users:
        embedded:
          enabled: true
          plain-text: true
          users:
            regularUser: "1!Letmein"
            adminUser: "1!Letmein"
          roles:
            regularUser: "inventoryView,inventoryEdit"
            adminUser: "inventoryView,inventoryEdit,inventoryAdmin"

"%intTest":
  service:
    tempDir: "/tmp/oqmTest/baseStation"
  
  #messaging:
  #  connector: smallrye-amqp
  
  quarkus:
    http:
      port: 8081
    log:
      level: INFO
      category:
    
    mongodb:
      database: openQuarterMasterTest
      write-concern:
        journal: false
    jaeger:
      enabled: true
    smallrye-openapi:
      info-title: Open QuarterMaster Base Station API (TEST)
    reactive-messaging:
      health:
        enabled: true
  
  mp:
    jwt:
      verify:
        issuer: "oqm-test"
        publickey:
          location: dev/devTest-cert-cert.pem
  smallrye:
    jwt:
      sign:
        key:
          location: dev/devTest-cert-key.pem
