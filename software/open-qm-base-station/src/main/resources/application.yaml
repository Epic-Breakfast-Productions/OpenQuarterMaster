# https://quarkus.io/guides/config-reference
service:
  version: ${quarkus.application.version}
  apiVersion: 1.0.0
  nameShort: OQMbase
  nameFull: Open Quarter Master Base Station
  gitLink: https://github.com/Epic-Breakfast-Productions/OpenQuarterMaster
  # TODO:: move data that doesn't need to be here
  auth:
    userSettingsUrl: ${quarkus.oidc.auth-server-url}/account/
  runBy:
    name: " "
    email: " "
    phone: " "
    website: " "
    logo: " "
    banner: ${service.runBy.logo}
    motd: >
      Your privacy is important to the original project. It only creates minor cookies, and that is for the login
      functionality. The project also only collects what you give it, and it is up to the people running the server to
      ensure it is handled well. Please contact the folks running the server for more information.
  ops:
    currency: "USD" # anything that works with `Currency.getInstance("<value>")`
  item:
    expiryCheck:
      cron: 0 0 * ? * * # Every Hour
  display:
    datetimeFormat: "" #TODO:: determine good time format, use wherever datetimes are displayed
  tempDir: "/tmp/oqm/baseStation"
    
productLookup:
  providers:
    barcodelookup-com:
      displayName: BarcodeLookup.com
      description: Comprehensive database of products, but a paid service.
      cost: Paid
      acceptsContributions: true
      homepage: https://www.barcodelookup.com/
      enabled: true
      url: https://api.barcodelookup.com/
      apiKey: " "
    datakick:
      displayName: Datakick
      description: The open product database, free and open database of products. Mostly for home and food goods. Limited size of database, but free and open to contributions.
      cost: Free
      acceptsContributions: true
      homepage: https://gtinsearch.org/
      enabled: true
      url: https://www.gtinsearch.org
    upcitemdb:
      displayName: upcitemdb.com
      description: A lookup database with good number of records, and a free tier with 100 requests per day.
      cost: Free tier, Paid
      acceptsContributions: false
      homepage: https://www.upcitemdb.com/
      enabled: true
      url: https://api.upcitemdb.com
      apiKey: " "
    rebrickable:
      displayName: Rebrickable
      description: A database of LEGO(TM) pieces. Free, but requires you to get your own key.
      cost: Free
      acceptsContributions: false
      homepage: https://rebrickable.com
      enabled: true
      url: https://rebrickable.com
      apiKey: " "
      
messaging:
  connector: ""

# TODO:: move this into `service` config
runningInfo:
  protocol: http
  hostname: localhost
  port: ${quarkus.http.port}
  hostnamePort: ${runningInfo.hostname}:${runningInfo.port}
  baseUrl: ${runningInfo.protocol}://${runningInfo.hostnamePort}
  fromEmail: no-reply@${runningInfo.baseUrl}

externalService:
  secretSizeMin: 50
  secretSizeMax: 100
  serviceTokenExpires: 86400 # 1 day
  extServices:
    # Service entries here
  
quarkus:
  application:
    name: ${service.nameShort} - V${service.apiVersion}
  rest-client:
    upc-barcodelookup-com:
      url: ${productLookup.providers.barcodelookup-com.url}
      scope: jakarta.inject.Singleton
    upc-datakick:
      url: ${productLookup.providers.datakick.url}
      scope: jakarta.inject.Singleton
    upc-upcitemdb:
      url: ${productLookup.providers.upcitemdb.url}
      scope: jakarta.inject.Singleton
    lego-rebrickable:
      url: ${productLookup.providers.rebrickable.url}
      scope: jakarta.inject.Singleton
  native:
    resources:
      includes: security/*
  log:
    level: DEBUG
    console:
      format: "%d{HH:mm:ss} [%-5p][%-16X{traceId}|%-2X{parentId}|%-16X{spanId}|%-5X{sampled}][%-40c{2.}|%-26t]():: %s%e%n"
    category:
      "org.mongodb.driver":
        level: INFO
  mongodb:
    database: openQuarterMaster
    tracing:
      enabled: true
  #  package:
  #    type: uber-jar
  scheduler:
    metrics:
      enabled: true
  
  # https://quarkus.io/guides/openapi-swaggerui
  smallrye-openapi:
    info-title: Open QuarterMaster Base Station API
    info-version: ${service.apiVersion}
    info-description: API documentation for the Open QuarterMaster Base Station. Provides all basic functionality. Running on service version ${service.version}
    #    info-terms-of-service: <url>
    info-contact-email: greg@epic-breakfast-productions.tech
    info-contact-name: EBP
    info-contact-url: ${service.gitLink}
    info-license-name: GNU General Public License v3.0
    info-license-url: ${service.gitLink}/blob/main/LICENSE
    security-scheme: jwt
    security-scheme-name: JwtAuth
  swagger-ui:
    always-include: true
    title: ${quarkus.smallrye-openapi.info-title} v${service.apiVersion}
    theme: flattop
    footer: With ❤️, EBP
  http:
    limits:
      max-body-size: 95M
    auth:
      proactive: false
      permission:
        logout:
          paths: ${quarkus.oidc.logout.path}
          policy: authenticated
    access-log:
      enabled: true
    port: 80
    ssl-port: 443
  mailer:
    from: ${runningInfo.fromEmail}
  reactive-messaging:
    health:
      enabled: true
    metrics:
      enabled: true
  qute:
    type-check-excludes:
      - "tech.ebp.oqm.baseStation.model.object.storage.checkout.checkoutFor.CheckoutFor.*"
  oidc:
    application-type: hybrid
    token-state-manager:
      split-tokens: true
    logout:
      path: /logout
      post-logout-path: /?message=You%20have%20successfully%20logged%20out&messageType=success&messageHeading=Logged%20Out
  
mp:
  jwt:
    verify:
      issuer: ${service.runBy.name}${service.nameShort} # set to ${service.externalAuth.realmBase:} for external
    expiration:
      default: 86400 # 1 day
      extended: 2678400 # 1 month

#  messaging:
#    outgoing:
#      items.add:
#        connector: ${messaging.connector}

smallrye:
  jwt:
    always-check-authorization: true

"%dev":
  quarkus:
    application:
      name: ${service.nameShort} - V${service.apiVersion} - DEV
    log:
      level: DEBUG
    opentelemetry:
      enabled: true
      tracer:
        exporter:
          otlp:
            endpoint: http://localhost:8096
    smallrye-openapi:
      info-title: Open QuarterMaster Base Station API (DEV)
    mongodb:
#      connection-string: mongodb://localhost:27017
    http:
      port: 8080
      ssl-port: 8443
      ssl:
        certificate:
          files: ../../../../dev/devTest-cert-cert.pem
          key-files: ../../../../dev/devTest-cert-key.pem
    oidc:
      client-id: oqm-app
      credentials:
        secret: "**********"
    keycloak:
      devservices:
        # Required to export realm
        start-command: "start --http-enabled=true --hostname-strict=false --hostname-strict-https=false"
        realm-path: "../../../../dev/oqm-realm.json"
        realm-name: "oqm"
  mp:
    jwt:
      expiration:
#        default: 60
      verify:
        privatekey:
          location: ../../../../dev/devTest-cert-key.pem
        publickey:
          location: ../../../../dev/devTest-cert-cert.pem
        issuer: ${service.runBy.name}${service.nameShort} # set to ${service.externalAuth.realmBase:} for external
  service:
    runBy:
      name: The Developers
      email: dev@devlopment.dev
      phone: 111-222-3333
      website: http://devlopment.dev
      logo: ../../../../dev/developers.jpeg

  
